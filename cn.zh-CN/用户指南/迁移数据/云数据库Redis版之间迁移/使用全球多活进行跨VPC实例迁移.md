# 使用全球多活进行跨VPC实例迁移 {#concept_v2c_qy5_cgb .concept}

利用云数据库Redis版的全球多活功能，您可以快速地将一个VPC中的Redis实例迁移到其它VPC中，与目的VPC的ECS或RDS实例进行交互。

## 什么是全球多活 {#section_dzv_x3j_wfb .section}

全球多活是阿里自研的、基于云数据库Redis版（ApsaraDB for Redis）且100%兼容Redis协议的多活数据库系统。通过数据同步通道，把多个Redis子实例组成一个逻辑上的多活网络，所有子实例均可读写并保持实时数据同步。您可以参考[什么是Redis全球多活](../../../../cn.zh-CN/全球多活/什么是 Redis 全球多活.md#)以获得更多相关信息。

如您的Redis实例创建到了与ECS以及RDS实例不同的VPC中，或者您需要调整业务架构，将现有Redis实例对接到另一个VPC网络中的其它阿里云产品时，将面临Redis与其它产品不在同一VPC而无法互通的情况。此时最快捷的解决方案是使用Redis全球多活进行跨VPC实例迁移。

## 迁移流程 {#section_a3z_5jj_wfb .section}

在创建多活实例的过程中，您需要为目标实例选择VPC。全球多活将根据您的选择在目的VPC创建一个目标实例，其规格与源实例相同。两个实例间将建立同步通道，数据实时同步。全量同步完成后，您选择合适的时机将流量切换到新的实例上，同时断开同步，删除多活实例和源实例。

 ![](images/34303_zh-CN.png "迁移流程图")

## 操作步骤 {#section_zxt_pqj_wfb .section}

1.  登录[Redis管理控制台](https://kvstore.console.aliyun.com/)。
2.  单击左侧导航栏的**全球多活**。
3.  在多活实例列表页，单击右侧的**创建多活实例**。

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/64697/155780189332710_zh-CN.png)

4.  在创建多活实例对话框，设置以下参数并单击**确定**。

    **说明：** 请根据您的业务需要选择目标实例的地域和可用区。

    |设置|说明|
    |--|--|
    |源实例地域|选择源实例所在的地域。|
    |源实例|选择源实例地域后，在该选项中选择多活实例的源实例。|
    |目标实例地域|选择创建多活实例的目标地域。|
    |目标实例可用区|在目标地域中选择目的可用区。|
    |目标实例名称|自定义目标实例名称。|
    |网络类型|选择目标实例的网络类型。 **说明：** 此处需选择专有网络，并选择与您的需要 Redis 与之交互的阿里云产品（如ECS或RDS）所在的VPC。

 |
    |目标实例付费类型|选择目标实例的付费类型。|
    |多活实例名称|自定义多活实例的名称。|

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/79955/155780189334312_zh-CN.png)

    **说明：** 在创建目标实例前，系统将自动升级源实例的小版本以支持多活同步功能，期间会发生5秒内的闪断和30秒内的实例只读，请提前做好准备。如需了解您的环境是否会发生小版本升级，请联系阿里云工程师确认当前源实例的小版本与支持多活同步的小版本。

5.  在订单确认页面，确认订单信息，阅读并勾选 *云数据库KvStore版服务条款* ，单击**去开通**。

    **说明：** 若源实例已经绑定了一个多活实例，则会提示“Source InstanceId already bound to a replica”。此时需将源实例断开同步，或者重新选择没有绑定的源实例。

6.  返回多活实例列表查看新多活实例的状态栏，确认初始化完成。

    **说明：** 此时状态栏显示初始化进度条，表示正在通过实例克隆和全量同步的方式进行迁移。初始化完成后，您可以在目的地域确认迁移后的实例信息。

    **说明：** 同步完成后，建议您检查新实例中数据的完整性。如无问题，即可选择合适的时机将业务切换到新的实例上，并进行接下来的释放操作。

7.  单击多活实例右侧操作栏的**断开同步**。![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/64697/155780189432709_zh-CN.png)
8.  [释放源实例](cn.zh-CN/用户指南/管理实例/释放实例.md#)。

**说明：** Redis全球多活可以帮助您在全球多地域构建稳定的多活同步架构，您可以查看其[应用场景](../../../../cn.zh-CN/全球多活/应用场景.md#)和[产品架构](../../../../cn.zh-CN/全球多活/产品架构.md#)来了解更多相关信息。

